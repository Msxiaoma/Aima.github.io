{"title":"Vuex 心得总结","date":"2018-07-20T09:45:04.000Z","excerpt":"","slug":"postName","updated":"2018-07-20T09:45:31.000Z","content":"<p>最近使用 vuex 在整个单页面项目组件间共享数据，以下 demo 通过 vuex 存储，修改、获取共享数据。由于之前没有使用过 vuex ,有什么不正确的地方，还请大家指正。</p>\n<h2 id=\"一、什么是Vuex\"><a href=\"#一、什么是Vuex\" class=\"headerlink\" title=\"一、什么是Vuex\"></a>一、什么是Vuex</h2><p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。也就是说 Vuex 用于单页面应用组件之间的数据共享，在组件嵌套很多层的情况下，Vue 中父子组件的通信过程就变得很麻烦，此时使用 Vuex 方便了组件间的通信。顺便说一下 HTML5 提供的数据存取机制 localStorage ，localStorage 存储的数据存在浏览器中，也就是本地磁盘中，localStorage 多数情况用于页面之间传递数据。Vuex 是将数据存储在了内存中，每一次刷新页面，之前存在 Vuex 中的数据就会重新初始化。</p>\n<h3 id=\"二、Vuex-的安装\"><a href=\"#二、Vuex-的安装\" class=\"headerlink\" title=\"二、Vuex 的安装\"></a>二、Vuex 的安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install vuex</span><br></pre></td></tr></table></figure>\n<h3 id=\"三、Vuex-的使用\"><a href=\"#三、Vuex-的使用\" class=\"headerlink\" title=\"三、Vuex 的使用\"></a>三、Vuex 的使用</h3><p>新建一个 store.js, 在 store.js 编写如下代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import Vue from <span class=\"string\">'vue'</span></span><br><span class=\"line\">import Vuex from <span class=\"string\">'vuex'</span></span><br><span class=\"line\"></span><br><span class=\"line\">Vue.use(Vuex)</span><br><span class=\"line\"></span><br><span class=\"line\">const state = &#123;          // 组件间共享的数据</span><br><span class=\"line\">    list: []</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">const mutations = &#123;      // 修改共享数据</span><br><span class=\"line\">    setList: (state, value) =&gt; &#123;    </span><br><span class=\"line\">        state.list = value</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">const getters = &#123;        // 获取共享数据</span><br><span class=\"line\">    getList: state =&gt; &#123;</span><br><span class=\"line\">        <span class=\"built_in\">return</span> state.list</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">export</span> default new Vuex.Store(&#123;</span><br><span class=\"line\">    getters,</span><br><span class=\"line\">    state,</span><br><span class=\"line\">    mutations</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>组件 setlist.vue 文件中修改共享数据<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">import &#123; mapMutations &#125; from <span class=\"string\">'vuex'</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> default &#123;</span><br><span class=\"line\">     <span class=\"function\"><span class=\"title\">mounted</span></span> () &#123;</span><br><span class=\"line\">        this.setList([<span class=\"string\">'hello'</span>])</span><br><span class=\"line\">     &#125;,</span><br><span class=\"line\">     methods: &#123;</span><br><span class=\"line\">        ...mapMutations([<span class=\"string\">'setList'</span>])</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>\n<p>组件 getlist.vue 文件中获取共享数据</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; mapGetters &#125; from <span class=\"string\">'vuex'</span></span><br><span class=\"line\">import &#123; mapState &#125; from <span class=\"string\">'vuex'</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> default &#123;</span><br><span class=\"line\">     computed: &#123;</span><br><span class=\"line\">        ...mapGetters([<span class=\"string\">'getList'</span> ])</span><br><span class=\"line\">     &#125;,</span><br><span class=\"line\">     <span class=\"function\"><span class=\"title\">mounted</span></span> () &#123;</span><br><span class=\"line\">        console.log(this.<span class=\"variable\">$store</span>.state.list)     // [<span class=\"string\">'hello'</span>]</span><br><span class=\"line\">        console.log(this.getList)               // [<span class=\"string\">'hello'</span>]</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>补充：<br>通过在根实例中注册 store 选项，该 store 实例会注入到根组件下的所有子组件中，且子组件能通过 this.$store 访问到。</p>\n<h3 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h3><p>More info: <a href=\"https://vuex.vuejs.org/zh/\" target=\"_blank\" rel=\"noopener\">https://vuex.vuejs.org/zh/</a></p>\n","next":{"title":"HTML5 拖拽批量上传文件","slug":"htm5_drap"},"link":"/2018/07/20","toc":[{"title":"一、什么是Vuex","id":"一、什么是Vuex","index":"1","children":[{"title":"二、Vuex 的安装","id":"二、Vuex-的安装","index":"1.1"},{"title":"三、Vuex 的使用","id":"三、Vuex-的使用","index":"1.2"},{"title":"参考文档","id":"参考文档","index":"1.3"}]}]}